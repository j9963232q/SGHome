(function(){"use strict";window.JT2html=function(e,t){var n,r,i,s,o,u,a,f,l,c;var h;if(e===undefined)throw"You must pass some template here, visit https://github.com/chgu82837/JT2htmlJS for the docs";t==null&&(t={});n={info:false,root:"body",pattern:/@\{(\w*)\}/,defaultValue:{href:"#"}};for(var p in n)if(typeof t[p]==="undefined")t[p]=n[p];r="JT2htmlERROR";i=function(n){var i,a,f,c,p,d,v;i="genHTML";h={};o("generating HTML...",i);a=e;f=n.length;while(--f>=0){c=l(n[f]);p=c["type"]+"";delete c["type"];d=a[p]||r;if(d===r){u('type:"'+p+'" is not defined!',i)}else{o('type:"'+p+'" is going to be processd...',i);for(v in c){h[v]=c[v]+(h[v]||"")}h[p]=s(d)+(h[p]||"")}}p=t.root;d=a[p]||r;if(d===r){u('root type:"'+p+'" is not defined!',i)}else{o('data collection done, generating root:"'+p+'"',i)}return s(d)};s=function(e){var n,r,i,s,o,u;n="genContext";r=e+"";i=[];while(s=r.match(t.pattern)){i.push(s[1]);r=r.substring(0,s.index)+(h[s[1]]||t.defaultValue[s[1]]||"")+r.substring(s.index+s[0].length)}for(o in i){u=i[o];h[u]=""}return r};o=t.info&&console.log?function(e,t){if(t){return console.log("[ JT2html:"+t+" ] => "+e)}else{return console.log(e)}}:function(){};u=console.warn?function(e,t){if(t){return console.warn("[ JT2html:"+t+" ] => "+e)}else{return console.warn(e)}}:function(){};a=function(e){var t,n,r={};for(t in e){n=e[t];if(t.substr(0,4)==="gsx$"){r[t.replace("gsx$","")]=n["$t"]}}return r};f=function(e){return e};l=f;c=function(e,t,n){var r="HttpGET";o("HttpGET fired",r);var i;var s=function(){if(i.readyState==4&&i.status==200||typeof XDomainRequest!="undefined"){o("GET success",r);t(i.responseText)}else if(i.readyState==4&&i.status!=200){u("GET Failed! status="+i.status,r);n(i)}};if(typeof XDomainRequest!="undefined"){rs_nav.message("Using XDomainRequest");i=new XDomainRequest;i.onload=s}else{i=new XMLHttpRequest;i.onreadystatechange=s}i.open("GET",e,true);i.send()};return{setJsonResolver:function(e){l=e},fromJson:function(e){var t;t="fromJson";o("JT2html fired",t);var n=i(e);l=f;return n},fromAjax:function(e,t,n){if(typeof t!=="function")t=function(){};if(typeof n!=="function")n=function(){};var r="fromAjax";o("JT2html fired",r);c(e,function(e){var n=JSON.parse(e);t(i(n.feed.entry));l=f},function(e){n(e);l=f});return"Use fromAjax.(url,success,fail) callback to get the rendered value!"},fromGSJson:function(e){var t="fromGSJson";l=a;o("JT2html fired",t);var n=i(e);l=f;return n},fromGS:function(e,t,n){if(typeof t!=="function")t=function(){};if(typeof n!=="function")n=function(){};var r="fromGS";l=a;o("JT2html fired",r);c(e,function(e){var n=JSON.parse(e);t(i(n.feed.entry));l=f},function(e){n(e);l=f});return"Use fromGS.(url,success,fail) callback to get the rendered value!"}}}}).call(this)
